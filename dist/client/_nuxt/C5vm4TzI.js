import{S as C,J as B,bw as j,o as c,c as _,b as o,w as e,Z as w,a as t,H as u,$ as b,V as M,I as O,p as A,e as E,_ as T,r as q,T as L,F as V,L as P,d as H,t as p,K as $,O as S}from"./dlBUJPxP.js";import{u as U}from"./DYHMA_ZV.js";import{V as r,a as m}from"./4c4Tojpe.js";import{_ as J}from"./ci7Psn9g.js";import{V as K}from"./xR8QRRp-.js";const k=l=>(A("data-v-82783dd3"),l=l(),E(),l),R={class:"profile"},Z=k(()=>t("span",null,"Телефон",-1)),z=k(()=>t("span",null,"Email",-1)),G=k(()=>t("span",null,"Имя",-1)),Q=k(()=>t("span",null,"Фамилия",-1)),W=C({__name:"UserProfile",setup(l){const a=B();U();const h=j().$envConfig,i=async()=>{await O.put(`${h.apiUrl}/api/user`,a.profile)};return(d,n)=>(c(),_("div",R,[o(m,null,{default:e(()=>[o(r,{cols:"5"},{default:e(()=>[Z]),_:1}),o(r,{cols:"6"},{default:e(()=>[w(t("input",{variant:"solo","onUpdate:modelValue":n[0]||(n[0]=s=>u(a).profile.phone=s),placeholder:"phone",disabled:""},null,512),[[b,u(a).profile.phone]])]),_:1})]),_:1}),o(m,null,{default:e(()=>[o(r,{cols:"5"},{default:e(()=>[z]),_:1}),o(r,{cols:"6"},{default:e(()=>[w(t("input",{variant:"solo","onUpdate:modelValue":n[1]||(n[1]=s=>u(a).profile.email=s),placeholder:"email"},null,512),[[b,u(a).profile.email]])]),_:1})]),_:1}),o(m,null,{default:e(()=>[o(r,{cols:"5"},{default:e(()=>[G]),_:1}),o(r,{cols:"6"},{default:e(()=>[w(t("input",{variant:"solo","onUpdate:modelValue":n[2]||(n[2]=s=>u(a).profile.name=s),placeholder:"Имя"},null,512),[[b,u(a).profile.name]])]),_:1})]),_:1}),o(m,null,{default:e(()=>[o(r,{cols:"5"},{default:e(()=>[Q]),_:1}),o(r,{cols:"6"},{default:e(()=>[w(t("input",{variant:"solo","onUpdate:modelValue":n[3]||(n[3]=s=>u(a).profile.surname=s),placeholder:"Фамилия"},null,512),[[b,u(a).profile.surname]])]),_:1})]),_:1}),o(r,{cols:"12"},{default:e(()=>[o(M,{class:"mt-4",style:{width:"200px"},text:"Сохранить",type:"button",onClick:i})]),_:1})]))}}),X=T(W,[["__scopeId","data-v-82783dd3"]]),D=l=>(A("data-v-260fcb6a"),l=l(),E(),l),Y={class:"orders-admin"},tt=D(()=>t("h1",{class:"title"},"Заказы админ",-1)),et=D(()=>t("thead",null,[t("tr",null,[t("th",{class:"text-left"},"Номер заказа"),t("th",{class:"text-left"},"Имя Клиента"),t("th",{class:"text-left"},"Телефон"),t("th",{class:"text-left"},"E-mail"),t("th",{class:"text-left"},"Итоговая сумма")])],-1)),at=C({__name:"OrderAdmin",setup(l){const a=U(),h=q([]);return L(async()=>{const i=await a.getOrders();h.value=i==null?void 0:i.data}),(i,d)=>{const n=J;return c(),_("div",Y,[tt,o(K,{class:"order-table",height:"300px","fixed-header":""},{default:e(()=>[et,t("tbody",null,[(c(!0),_(V,null,P(h.value,s=>(c(),_("tr",{key:s._id,class:"order-row"},[t("td",null,[o(n,{to:`/admin/order/${s._id}`,class:"order-link"},{default:e(()=>[H(p(s.number),1)]),_:2},1032,["to"])]),t("td",null,p(s.guestContact.name),1),t("td",null,p(s.guestContact.phone),1),t("td",null,p(s.guestContact.email),1),t("td",null,p(s.totalPrice)+"₴",1)]))),128))])]),_:1})])}}}),ot=T(at,[["__scopeId","data-v-260fcb6a"]]),F=l=>(A("data-v-899428f1"),l=l(),E(),l),st={class:"font-weight-bold"},lt=F(()=>t("span",{class:"font-weight-bold text-success"},"Оформлен",-1)),nt=["src"],rt={style:{color:"grey"}},ct=F(()=>t("span",{class:"font-weight-bold"},"К оплате:",-1)),ut={class:"font-weight-bold"},it=C({__name:"OrderUser",setup(l){const a=B(),h=U(),i=j().$envConfig,d=q([]),n=async()=>{await O.put(`${i.apiUrl}/api/user`,a.profile)};return L(async()=>{const s=await h.getOrder();if(d.value=s==null?void 0:s.data,!a.profile)return;const{name:I,surname:v,email:f}=a.profile;if(d.value.length>0&&(!I||!v||!f)){const{name:g,surname:y,email:x}=d.value[d.value.length-1].guestContact;!I&&g&&(a.profile.name=g),!v&&y&&(a.profile.surname=y),!f&&x&&(a.profile.email=x),n()}d.value=await Promise.all(d.value.map(async g=>{const y=await Promise.all(g.products.map(async x=>{const{data:N}=await O.get(`${i.apiUrl}/api/product/${x.product}`);return{productName:N.name,productImg:N.image[0],quantity:x.quantity,price:N.price}}));return g.products=y,g}))}),(s,I)=>(c(),_("div",null,[(c(!0),_(V,null,P(d.value,v=>(c(),$(m,{key:v.number,class:"order"},{default:e(()=>[o(r,{cols:"12",class:"mb-6"},{default:e(()=>[o(m,{justify:"space-between",align:"center"},{default:e(()=>[t("span",st,"Заказ №"+p(v.number),1),lt]),_:2},1024)]),_:2},1024),(c(!0),_(V,null,P(v.products,f=>(c(),$(r,{key:f.productName,cols:"12"},{default:e(()=>[o(m,{align:"center"},{default:e(()=>[o(r,{cols:"2",class:"pa-0"},{default:e(()=>[t("img",{class:"w-100",src:`${u(i).apiUrl}/${f.productImg}`,alt:"product"},null,8,nt)]),_:2},1024),o(r,{cols:"6"},{default:e(()=>[t("div",null,p(f.productName),1),t("div",rt,p(f.quantity)+" шт.",1),t("div",null,p(f.price)+" грн/шт.",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),o(r,{cols:"12"},{default:e(()=>[o(m,{justify:"space-between",align:"center"},{default:e(()=>[ct,t("span",ut,p(v.totalPrice)+" грн.",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]))}}),dt=T(it,[["__scopeId","data-v-899428f1"]]),pt={class:"profile pa-2"},_t=t("h1",{class:"d-flex justify-center ma-3"},"Профиль",-1),xt=C({__name:"profile",setup(l){const a=B();return U(),(h,i)=>{const d=X,n=ot,s=dt;return c(),_("div",pt,[_t,u(a).profile?(c(),$(d,{key:0})):S("",!0),u(a).profile?(c(),_(V,{key:1},[u(a).profile.role==="admin"?(c(),$(n,{key:0})):S("",!0),u(a).profile.role==="customer"?(c(),$(s,{key:1})):S("",!0)],64)):S("",!0)])}}});export{xt as default};
